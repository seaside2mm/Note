

##  `scalar.h`  
`using Scalar = double;`

##  `fixed_vector.h`

```c++
#define HOST_DEVICE __host__ __device__ inline
template <typename T, int N>
struct Vec
{
    HOST_DEVICE Vec(const T* values) { for (int i = 0; i < N; i++) data[i] = values[i]; }
    
    T data[N];
}
```


##  `device_buffer.h`

- `T* data_;`  //数据首地址
- `size_t size_, capacity_`
- `bool allocated_` 
```mermaid
graph TD
%%此图示由列表文本转换而成！%%





```
```c++

template <typename T>
class DeviceBuffer
{
public:

	void allocate(size_t count)
	{
		if (data_ && capacity_ >= count)
			return;

		destroy();
		CUDA_CHECK(cudaMalloc(&data_, sizeof(T) * count));
		capacity_ = count;
		allocated_ = true;
	}


	void resize(size_t size)
	{
		allocate(size);
		size_ = size;
	}

	void map(size_t size, void* data)
	{
		data_ = (T*)data;
		size_ = size;
		allocated_ = false;
	}

	void assign(size_t size, const void* h_data)
	{
		resize(size);
		upload((T*)h_data);
	}

	void upload(const T* h_data)
	void download(T* h_data) const
	void fillZero()
};

```
